function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,s){for(var t=0;t<s.length;t++){var i=s[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,s,t){return s&&_defineProperties(e.prototype,s),t&&_defineProperties(e,t),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"7UCR":function(e,s,t){"use strict";t.r(s),t.d(s,"UserModule",(function(){return Re}));var i=t("3Pt+"),r=t("ofXK"),n=t("jCJ1"),a=t("bTqV"),c=t("NFeN"),o=t("qFsG"),l=t("tyNb"),b=t("fXoL"),u=t("flj8"),h=t("2uAV"),d=t("YiK1"),f=t("kmnG");function g(e,s){if(1&e&&(b.Sb(0,"li",33),b.Jc(1),b.Rb()),2&e){var t=s.$implicit;b.Ab(1),b.Kc(t)}}function p(e,s){if(1&e&&(b.Sb(0,"div"),b.Hc(1,g,2,1,"li",32),b.Rb()),2&e){var t=b.ec(2);b.Ab(1),b.lc("ngForOf",t.formValidator.email.errMsgs)}}function m(e,s){if(1&e&&(b.Sb(0,"li",33),b.Jc(1),b.Rb()),2&e){var t=s.$implicit;b.Ab(1),b.Kc(t)}}function v(e,s){if(1&e&&(b.Sb(0,"div"),b.Hc(1,m,2,1,"li",32),b.Rb()),2&e){var t=b.ec(2);b.Ab(1),b.lc("ngForOf",t.formValidator.passwd.errMsgs)}}function S(e,s){1&e&&(b.Sb(0,"span",37),b.Jc(1,"Please click the above button."),b.Rb())}function w(e,s){if(1&e){var t=b.Tb();b.Sb(0,"div",34),b.Sb(1,"re-captcha",35),b.ac("resolved",(function(e){return b.zc(t),b.ec(2).handleCorrectCaptcha(e)})),b.Rb(),b.Hc(2,S,2,0,"span",36),b.Rb()}if(2&e){var i=b.ec(2);b.Ab(1),b.lc("siteKey",i.reCaptchaSiteKey),b.Ab(1),b.lc("ngIf",i.isChecking&&!i._viewControls.isRecaptchaClicked)}}function C(e,s){if(1&e){var t=b.Tb();b.Sb(0,"form",10,11),b.ac("ngSubmit",(function(){return b.zc(t),b.ec().onSubmit()})),b.Sb(2,"div",12),b.Sb(3,"label",13),b.Jc(4,"Email"),b.Rb(),b.Sb(5,"div",14),b.Sb(6,"mat-form-field",15),b.Sb(7,"input",16,17),b.ac("ngModelChange",(function(e){return b.zc(t),b.ec().theUser.email=e}))("keyup",(function(){return b.zc(t),b.ec().formValidator.email.presetErrs=[]})),b.Rb(),b.Rb(),b.Hc(9,p,2,1,"div",9),b.Rb(),b.Rb(),b.Sb(10,"div",12),b.Sb(11,"label",18),b.Jc(12,"Password"),b.Rb(),b.Sb(13,"div",14),b.Sb(14,"mat-form-field",15),b.Sb(15,"input",19,17),b.ac("ngModelChange",(function(e){return b.zc(t),b.ec().theUser.passwd=e}))("keyup",(function(){return b.zc(t),b.ec().formValidator.passwd.presetErrs=[]})),b.Rb(),b.Rb(),b.Hc(17,v,2,1,"div",9),b.Rb(),b.Rb(),b.Hc(18,w,3,2,"div",20),b.Sb(19,"div",21),b.Sb(20,"div",22),b.Sb(21,"button",23),b.Jc(22,"Sign In"),b.Rb(),b.Rb(),b.Sb(23,"div",22),b.Sb(24,"button",24),b.ac("click",(function(){return b.zc(t),b.ec().resetForm()})),b.Jc(25,"Reset"),b.Rb(),b.Rb(),b.Rb(),b.Nb(26,"div",25),b.Sb(27,"div",26),b.Sb(28,"span",27),b.Jc(29,"or"),b.Rb(),b.Rb(),b.Sb(30,"div",28),b.Sb(31,"button",29),b.ac("click",(function(e){return b.zc(t),b.ec().gotoAuth(e,"Google")})),b.Nb(32,"span",30),b.Jc(33," Google "),b.Rb(),b.Rb(),b.Nb(34,"div",31),b.Rb()}if(2&e){var i=b.ec();b.Ab(2),b.lc("ngClass",i.validEmail()),b.Ab(5),b.lc("ngModel",i.theUser.email),b.Ab(2),b.lc("ngIf",i.isChecking),b.Ab(1),b.lc("ngClass",i.validPasswd()),b.Ab(5),b.lc("ngModel",i.theUser.passwd),b.Ab(2),b.lc("ngIf",i.isChecking&&i.isPasswdChecking),b.Ab(1),b.lc("ngIf",i.reCaptchaSiteKey),b.Ab(13),b.lc("disabled",!i.googleClientID)}}function R(e,s){1&e&&(b.Sb(0,"div"),b.Sb(1,"h3"),b.Jc(2,"We are now signing you in..."),b.Rb(),b.Rb())}var k,y=function(){return["/home"]},A=((k=function(){function e(s,t,i,r){_classCallCheck(this,e),this.userService=s,this.router=t,this.infoService=i,this.systemService=r,this._subs=[],this.formValidator={email:{errMsgs:[],presetErrs:[]},passwd:{errMsgs:[],presetErrs:[]}},this.isSubmitted=!1,this.theUser={email:"",passwd:""},this.isChecking=!1,this.cssSuccess={"has-success":!0,"has-error":!1},this.cssError={"has-success":!1,"has-error":!0},this.cssHidden={"has-success":!1,"has-error":!1},this._viewControls={isRecaptchaClicked:!1}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.systemService.toggleNavbar(!0),this.systemService.toggleSidebar(!0),this.userService.isSignedIn&&(this.router.navigate(["/project/list"]),console.log("ToDo: will navigate to user information.")),this._subs.push(this.userService.currentUser$.subscribe((function(s){s.isLoggedIn&&e.router.navigate(["/project/list"])}))),this._subs.push(this.systemService.sysInfo$.subscribe((function(s){s&&(e.reCaptchaSiteKey=s.reCaptchaSiteKey,e.googleClientID=s.googleClientID)})))}},{key:"validEmail",value:function(){var e=this.formValidator.email,s=new RegExp('^(([^<>()[\\]\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\.,;:\\s@"]+)*)|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$');return e.errMsgs.length=0,e.presetErrs.length>0&&e.errMsgs.push.apply(e.errMsgs,e.presetErrs),s.test(this.theUser.email)||e.errMsgs.push("Please check your email format."),this.isChecking?0===e.errMsgs.length?this.cssSuccess:this.cssError:this.cssHidden}},{key:"validPasswd",value:function(){var e=this.formValidator.passwd,s=this.theUser.passwd&&this.theUser.passwd.length?this.theUser.passwd.length:0;return e.errMsgs.length=0,e.presetErrs.length>0&&e.errMsgs.push.apply(e.errMsgs,e.presetErrs),(s<8||s>64)&&e.errMsgs.push("This password must be between 8 and 64 characters"),0===s&&e.errMsgs.push("Cannot be empty"),this.isChecking&&this.isPasswdChecking?0===e.errMsgs.length?this.cssSuccess:this.cssError:this.cssHidden}},{key:"handleCorrectCaptcha",value:function(e){this.recaptchaResponse=e}},{key:"onSubmit",value:function(){var e=this;this.isChecking=!1,this.isPasswdChecking=!1,(this.validEmail()||this.validPasswd())&&(this.isChecking=!0,this.isPasswdChecking=!0,this._viewControls.isRecaptchaClicked=!!this.recaptchaResponse,0===this.formValidator.email.errMsgs.length&&0===this.formValidator.passwd.errMsgs.length&&(this.reCaptchaSiteKey&&this.recaptchaResponse||!this.reCaptchaSiteKey)?(this._subs.push(this.userService.signIn(this.theUser.email,this.theUser.passwd,this.recaptchaResponse).subscribe((function(s){s.isError?(e.formValidator.email.presetErrs=[],e.formValidator.passwd.presetErrs=[],e.isSubmitted=!1,setTimeout((function(){return e.reCaptchaComponent&&e.reCaptchaComponent.reset()}),0),e.isPasswdChecking=!1,e.theUser.passwd=""):(console.log("Sign in Successfully"),e.infoService.addMessage("11"),e.router.navigate([e.userService.redirectUrl?e.userService.redirectUrl:"/project/list"]))}))),this.isSubmitted=!0):this.reCaptchaComponent&&this.reCaptchaComponent.reset&&this.reCaptchaComponent.reset())}},{key:"gotoAuth",value:function(e,s){e.preventDefault(),e.stopImmediatePropagation(),this.userService.oAuthSign(s)}},{key:"resetForm",value:function(){return this.theUser={email:"",passwd:""},this.formValidator={email:{errMsgs:[],presetErrs:[]},passwd:{errMsgs:[],presetErrs:[]}},this.isChecking=!1,this.reCaptchaComponent&&this.reCaptchaComponent.reset()}},{key:"ngOnDestroy",value:function(){this._subs.forEach((function(e){return e.unsubscribe()}))}}]),e}()).\u0275fac=function(e){return new(e||k)(b.Mb(u.a),b.Mb(l.c),b.Mb(h.a),b.Mb(d.a))},k.\u0275cmp=b.Gb({type:k,selectors:[["user-login"]],viewQuery:function(e,s){var t;1&e&&b.Pc(n.a,!0),2&e&&b.vc(t=b.bc())&&(s.reCaptchaComponent=t.first)},decls:17,vars:4,consts:[[1,"container-fluid"],["aria-label","breadcrumb","role","navigation"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"bdp-main-container"],[1,"chi-header"],["class","form col-md-12 center-block",3,"ngSubmit",4,"ngIf"],[4,"ngIf"],[1,"form","col-md-12","center-block",3,"ngSubmit"],["userForm","ngForm"],[1,"form-group","row",3,"ngClass"],["for","email",1,"col-sm-2","control-label"],[1,"col-sm-10"],[2,"width","100%"],["matInput","","type","text","name","email","placeholder","What's your email address?",3,"ngModel","ngModelChange","keyup"],["email","ngModel"],["for","passwd",1,"col-sm-2","control-label"],["matInput","","type","password","name","passwd","placeholder","Choose a password",3,"ngModel","ngModelChange","keyup"],["class","form-group row","style","padding-left: 10px;",4,"ngIf"],[1,"form-group","row"],[1,"col-sm-2"],["mat-raised-button","","color","primary","type","submit"],["mat-button","","type","reset",3,"click"],[1,"clearfix"],[1,"my-3",2,"margin","10px","border-top","1px solid #8e95a5","text-align","center","height","0px","margin","10px"],[2,"position","relative","bottom","10px","background","rgba(255, 255, 255, 0.5)","padding","0 12px"],[1,"row",2,"padding","10px"],[1,"btn","btn-danger","col-sm-3","col-xs-6","pull-left","text-center",2,"height","40px",3,"disabled","click"],[1,"fab","fa-google"],[1,"text-center",2,"font-size","12pt"],["class","help-block text-danger",4,"ngFor","ngForOf"],[1,"help-block","text-danger"],[1,"form-group","row",2,"padding-left","10px"],["size","normal",3,"siteKey","resolved"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(e,s){1&e&&(b.Sb(0,"div",0),b.Sb(1,"nav",1),b.Sb(2,"ol",2),b.Sb(3,"li",3),b.Sb(4,"a",4),b.Jc(5,"Home"),b.Rb(),b.Rb(),b.Sb(6,"li",5),b.Jc(7,"Sign in"),b.Rb(),b.Rb(),b.Rb(),b.Sb(8,"div",6),b.Sb(9,"h3",7),b.Jc(10,"Sign In"),b.Rb(),b.Nb(11,"br"),b.Nb(12,"br"),b.Nb(13,"br"),b.Hc(14,C,35,8,"form",8),b.Hc(15,R,3,0,"div",9),b.Nb(16,"hr"),b.Rb(),b.Rb()),2&e&&(b.Ab(4),b.lc("routerLink",b.oc(3,y)),b.Ab(10),b.lc("ngIf",!s.isSubmitted),b.Ab(1),b.lc("ngIf",s.isSubmitted))},directives:[l.f,r.n,i.o,i.j,i.k,r.l,f.b,o.a,i.b,i.i,i.l,a.b,r.m,n.a],encapsulation:2}),k);function M(e,s){if(1&e&&(b.Sb(0,"li",37),b.Jc(1),b.Rb()),2&e){var t=s.$implicit;b.Ab(1),b.Kc(t)}}function E(e,s){if(1&e&&(b.Sb(0,"div"),b.Hc(1,M,2,1,"li",36),b.Rb()),2&e){var t=b.ec(2);b.Ab(1),b.lc("ngForOf",t.formValidator.email.errMsgs)}}function I(e,s){if(1&e&&(b.Sb(0,"li",37),b.Jc(1),b.Rb()),2&e){var t=s.$implicit;b.Ab(1),b.Kc(t)}}function J(e,s){if(1&e&&(b.Sb(0,"div"),b.Hc(1,I,2,1,"li",36),b.Rb()),2&e){var t=b.ec(2);b.Ab(1),b.lc("ngForOf",t.formValidator.passwd.errMsgs)}}function x(e,s){if(1&e&&(b.Sb(0,"li",37),b.Jc(1),b.Rb()),2&e){var t=s.$implicit;b.Ab(1),b.Kc(t)}}function H(e,s){if(1&e&&(b.Sb(0,"div"),b.Hc(1,x,2,1,"li",36),b.Rb()),2&e){var t=b.ec(2);b.Ab(1),b.lc("ngForOf",t.formValidator.passwd2.errMsgs)}}function N(e,s){if(1&e){var t=b.Tb();b.Sb(0,"re-captcha",38),b.ac("resolved",(function(e){return b.zc(t),b.ec(2).handleCorrectCaptcha(e)})),b.Rb()}if(2&e){var i=b.ec(2);b.lc("siteKey",i.reCaptchaSiteKey)}}function U(e,s){1&e&&(b.Sb(0,"span",37),b.Jc(1,"Please click the above button."),b.Rb())}function _(e,s){if(1&e){var t=b.Tb();b.Sb(0,"form",12,13),b.ac("ngSubmit",(function(){return b.zc(t),b.ec().onSubmit()})),b.Sb(2,"div",14),b.Sb(3,"label",15),b.Jc(4,"Email"),b.Rb(),b.Sb(5,"div",16),b.Sb(6,"mat-form-field",17),b.Sb(7,"input",18,19),b.ac("ngModelChange",(function(e){return b.zc(t),b.ec().theUser.email=e}))("keyup",(function(){return b.zc(t),b.ec().formValidator.email.presetErrs=[]})),b.Rb(),b.Rb(),b.Hc(9,E,2,1,"div",11),b.Rb(),b.Rb(),b.Sb(10,"div",14),b.Sb(11,"label",20),b.Jc(12,"Password"),b.Rb(),b.Sb(13,"div",16),b.Sb(14,"mat-form-field",17),b.Sb(15,"input",21,19),b.ac("ngModelChange",(function(e){return b.zc(t),b.ec().theUser.passwd=e}))("keyup",(function(){return b.zc(t),b.ec().formValidator.passwd.presetErrs=[]})),b.Rb(),b.Rb(),b.Hc(17,J,2,1,"div",11),b.Rb(),b.Rb(),b.Sb(18,"div",14),b.Sb(19,"label",22),b.Jc(20,"Re-type password"),b.Rb(),b.Sb(21,"div",16),b.Sb(22,"mat-form-field",17),b.Sb(23,"input",23),b.ac("ngModelChange",(function(e){return b.zc(t),b.ec().theUser.passwd2=e}))("keyup",(function(){return b.zc(t),b.ec().formValidator.passwd2.presetErrs=[]})),b.Rb(),b.Rb(),b.Hc(24,H,2,1,"div",11),b.Rb(),b.Rb(),b.Sb(25,"div",24),b.Hc(26,N,1,1,"re-captcha",25),b.Hc(27,U,2,0,"span",10),b.Rb(),b.Sb(28,"div",24),b.Sb(29,"div",26),b.Sb(30,"button",27),b.Jc(31,"Register"),b.Rb(),b.Rb(),b.Sb(32,"div",26),b.Sb(33,"button",28),b.ac("click",(function(){return b.zc(t),b.ec().resetForm()})),b.Jc(34,"Reset"),b.Rb(),b.Rb(),b.Rb(),b.Nb(35,"div",29),b.Sb(36,"div",30),b.Sb(37,"span",31),b.Jc(38,"or"),b.Rb(),b.Rb(),b.Sb(39,"div",32),b.Sb(40,"button",33),b.ac("click",(function(e){return b.zc(t),b.ec().gotoAuth(e,"Google")})),b.Nb(41,"span",34),b.Jc(42," Google "),b.Rb(),b.Rb(),b.Nb(43,"div",35),b.Rb()}if(2&e){var i=b.ec();b.Ab(2),b.lc("ngClass",i.validEmail()),b.Ab(5),b.lc("ngModel",i.theUser.email),b.Ab(2),b.lc("ngIf",i.isChecking),b.Ab(1),b.lc("ngClass",i.validPasswd()),b.Ab(5),b.lc("ngModel",i.theUser.passwd),b.Ab(2),b.lc("ngIf",i.isChecking),b.Ab(1),b.lc("ngClass",i.validPasswd2()),b.Ab(5),b.lc("ngModel",i.theUser.passwd2),b.Ab(1),b.lc("ngIf",i.isChecking),b.Ab(2),b.lc("ngIf",i.reCaptchaSiteKey),b.Ab(1),b.lc("ngIf",i.isChecking&&!i._viewControls.isRecaptchaClicked&&i.reCaptchaSiteKey),b.Ab(13),b.lc("disabled",!i.googleClientID)}}function V(e,s){if(1&e&&(b.Sb(0,"h3"),b.Nb(1,"i",39),b.Jc(2,"Sending registration information"),b.Rb()),2&e){var t=b.ec();b.Db("text-danger",t.hasErrors.length>0),b.Ab(1),b.lc("ngClass",t.sendInfoCss())}}function P(e,s){1&e&&(b.Sb(0,"h3",37),b.Nb(1,"i",40),b.Jc(2,"Some errors have occurred."),b.Rb())}function z(e,s){if(1&e&&(b.Sb(0,"li",37),b.Nb(1,"i",42),b.Jc(2),b.Rb()),2&e){var t=s.$implicit;b.Ab(2),b.Kc(t)}}function K(e,s){if(1&e){var t=b.Tb();b.Sb(0,"h4"),b.Jc(1," Please check the followings and "),b.Sb(2,"a",41),b.ac("click",(function(){b.zc(t);var e=b.ec();return e.isSubmitted=!e.isSubmitted})),b.Jc(3,"click here"),b.Rb(),b.Jc(4," to try again. "),b.Nb(5,"br"),b.Sb(6,"ul"),b.Hc(7,z,3,1,"li",36),b.Rb(),b.Rb()}if(2&e){var i=b.ec();b.Ab(7),b.lc("ngForOf",i.hasErrors)}}function T(e,s){1&e&&(b.Sb(0,"div"),b.Sb(1,"h3",43),b.Nb(2,"i",44),b.Jc(3," You have succssfully signed up! "),b.Nb(4,"br"),b.Jc(5," An email with an activation code was sent to your email address. If the email does not appear in your inbox in 5-10 minutes, please check your spam folder. "),b.Rb(),b.Nb(6,"hr"),b.Sb(7,"h3"),b.Jc(8,"You may now proceed to the followings. "),b.Rb(),b.Sb(9,"h4"),b.Sb(10,"ul"),b.Sb(11,"li"),b.Jc(12," Haven't recieved the email? "),b.Sb(13,"button"),b.Jc(14,"Click here"),b.Rb(),b.Jc(15," to resend the verification email. "),b.Rb(),b.Sb(16,"li"),b.Jc(17," Update your information. "),b.Rb(),b.Sb(18,"li"),b.Jc(19," Create a new project and upload your files. "),b.Rb(),b.Rb(),b.Rb(),b.Rb())}var F=function(){return["/home"]};function L(e,s){if(1&e&&(b.Sb(0,"h3",3),b.Nb(1,"i",4),b.Jc(2),b.Rb()),2&e){var t=b.ec();b.lc("ngClass",t.headerCss()),b.Ab(1),b.lc("ngClass",t.setCssClass()),b.Ab(1),b.Lc(" ",t.heading,"")}}var O=function(){return["/account/signIn"]};function D(e,s){1&e&&(b.Sb(0,"li"),b.Sb(1,"a",5),b.Jc(2,"Sign in to resend the verification email."),b.Rb(),b.Rb()),2&e&&(b.Ab(1),b.lc("routerLink",b.oc(1,O)))}function j(e,s){1&e&&(b.Sb(0,"li"),b.Sb(1,"a",5),b.Jc(2,"Sign in"),b.Rb(),b.Rb()),2&e&&(b.Ab(1),b.lc("routerLink",b.oc(1,O)))}function G(e,s){if(1&e&&(b.Sb(0,"div"),b.Hc(1,D,3,2,"li",2),b.Hc(2,j,3,2,"li",2),b.Rb()),2&e){var t=b.ec();b.Ab(1),b.lc("ngIf",!t.isVerified),b.Ab(1),b.lc("ngIf",t.isVerified)}}var $=function(){return["/project/list"]};function q(e,s){1&e&&(b.Sb(0,"li"),b.Sb(1,"a",5),b.Jc(2,"View my projects"),b.Rb(),b.Rb()),2&e&&(b.Ab(1),b.lc("routerLink",b.oc(1,$)))}var W=function(){return["/account/profile"]};function Y(e,s){1&e&&(b.Sb(0,"li"),b.Sb(1,"a",5),b.Jc(2,"Resend the verification email"),b.Rb(),b.Rb()),2&e&&(b.Ab(1),b.lc("routerLink",b.oc(1,W)))}function Z(e,s){if(1&e&&(b.Sb(0,"div"),b.Hc(1,q,3,2,"li",2),b.Hc(2,Y,3,2,"li",2),b.Rb()),2&e){var t=b.ec();b.Ab(1),b.lc("ngIf",t.isVerified),b.Ab(1),b.lc("ngIf",!t.isVerified)}}function Q(e,s){1&e&&b.Nb(0,"h3")}function X(e,s){if(1&e){var t=b.Tb();b.Sb(0,"span"),b.Jc(1),b.Sb(2,"button",16),b.Sb(3,"i",17),b.ac("click",(function(){return b.zc(t),b.ec(2)._viewControls.isEditName=!0})),b.Rb(),b.Rb(),b.Rb()}if(2&e){var i=b.ec(2);b.Ab(1),b.Lc("",i.currentUser.name?i.currentUser.name:"unnamed"," ")}}function B(e,s){if(1&e){var t=b.Tb();b.Sb(0,"div"),b.Sb(1,"mat-form-field"),b.Sb(2,"input",18),b.ac("ngModelChange",(function(e){return b.zc(t),b.ec(2)._viewControls.newName=e}))("keyup.enter",(function(){return b.zc(t),b.ec(2).rename()})),b.Rb(),b.Rb(),b.Sb(3,"button",19),b.ac("click",(function(){return b.zc(t),b.ec(2).rename()})),b.Nb(4,"i",20),b.Rb(),b.Sb(5,"button",21),b.ac("click",(function(){b.zc(t);var e=b.ec(2);return e._viewControls.newName=e.currentUser.name,e._viewControls.isEditName=!1})),b.Nb(6,"i",22),b.Rb(),b.Rb()}if(2&e){var i=b.ec(2);b.Ab(2),b.lc("ngModel",i._viewControls.newName)}}function ee(e,s){if(1&e){var t=b.Tb();b.Sb(0,"a",24),b.ac("click",(function(){return b.zc(t),b.ec(3).reVerify()})),b.Jc(1,"Re-send"),b.Rb()}}function se(e,s){1&e&&(b.Sb(0,"span"),b.Jc(1,"Sending ... "),b.Nb(2,"i",25),b.Rb())}function te(e,s){1&e&&(b.Sb(0,"span"),b.Jc(1,"Verification email sent."),b.Rb())}function ie(e,s){if(1&e&&(b.Sb(0,"span"),b.Jc(1," Waiting for email verification "),b.Nb(2,"br"),b.Jc(3," (Haven't recieved your verification email? "),b.Hc(4,ee,2,0,"a",23),b.Hc(5,se,3,0,"span",13),b.Hc(6,te,2,0,"span",13),b.Jc(7," ) "),b.Rb()),2&e){var t=b.ec(2);b.Ab(4),b.lc("ngIf",t._viewControls.showResendEmail),b.Ab(1),b.lc("ngIf",!t._viewControls.mailSent&&!t._viewControls.showResendEmail),b.Ab(1),b.lc("ngIf",t._viewControls.mailSent)}}function re(e,s){1&e&&(b.Sb(0,"span"),b.Jc(1,"Guest user (account inactive)"),b.Rb())}function ne(e,s){1&e&&(b.Sb(0,"span"),b.Jc(1,"Normal user"),b.Rb())}function ae(e,s){1&e&&(b.Sb(0,"span"),b.Jc(1,"Root"),b.Rb())}function ce(e,s){1&e&&(b.Sb(0,"span"),b.Jc(1,"Guest user (account inactive)"),b.Rb())}function oe(e,s){1&e&&(b.Sb(0,"span"),b.Jc(1,"Normal user"),b.Rb())}function le(e,s){1&e&&(b.Sb(0,"span"),b.Jc(1,"Power user"),b.Rb())}function be(e,s){1&e&&(b.Sb(0,"span"),b.Jc(1,"Task builder"),b.Rb())}function ue(e,s){1&e&&(b.Sb(0,"span"),b.Jc(1,"Task manager"),b.Rb())}function he(e,s){1&e&&(b.Sb(0,"span"),b.Jc(1,"Administrator"),b.Rb())}function de(e,s){if(1&e&&(b.Sb(0,"div",9),b.Sb(1,"div",10),b.Sb(2,"div",11),b.Sb(3,"strong"),b.Jc(4,"Name"),b.Rb(),b.Rb(),b.Sb(5,"div",12),b.Hc(6,X,4,1,"span",13),b.Hc(7,B,7,1,"div",13),b.Rb(),b.Rb(),b.Nb(8,"br"),b.Sb(9,"div",10),b.Sb(10,"div",11),b.Sb(11,"strong"),b.Jc(12,"E-mail"),b.Rb(),b.Rb(),b.Sb(13,"div",12),b.Jc(14),b.Rb(),b.Rb(),b.Nb(15,"br"),b.Sb(16,"div",10),b.Sb(17,"div",11),b.Sb(18,"strong"),b.Jc(19,"System Role"),b.Rb(),b.Rb(),b.Sb(20,"div",14),b.Hc(21,ie,8,3,"span",15),b.Hc(22,re,2,0,"span",15),b.Hc(23,ne,2,0,"span",15),b.Hc(24,ae,2,0,"span",15),b.Rb(),b.Rb(),b.Nb(25,"br"),b.Sb(26,"div",10),b.Sb(27,"div",11),b.Sb(28,"strong"),b.Jc(29,"Platform Role"),b.Rb(),b.Rb(),b.Sb(30,"div",14),b.Hc(31,ce,2,0,"span",15),b.Hc(32,oe,2,0,"span",15),b.Hc(33,le,2,0,"span",15),b.Hc(34,be,2,0,"span",15),b.Hc(35,ue,2,0,"span",15),b.Hc(36,he,2,0,"span",15),b.Rb(),b.Rb(),b.Rb()),2&e){var t=b.ec();b.Ab(6),b.lc("ngIf",!t._viewControls.isEditName),b.Ab(1),b.lc("ngIf",t._viewControls.isEditName),b.Ab(7),b.Lc(" ",null==t.currentUser?null:t.currentUser.email," "),b.Ab(6),b.lc("ngSwitch",t.currentUser.auths.base),b.Ab(1),b.lc("ngSwitchCase",0),b.Ab(1),b.lc("ngSwitchCase",1),b.Ab(1),b.lc("ngSwitchCase",2),b.Ab(1),b.lc("ngSwitchCase",9),b.Ab(6),b.lc("ngSwitch",t.currentUser.auths.bdp),b.Ab(1),b.lc("ngSwitchCase",1),b.Ab(1),b.lc("ngSwitchCase",2),b.Ab(1),b.lc("ngSwitchCase",3),b.Ab(1),b.lc("ngSwitchCase",7),b.Ab(1),b.lc("ngSwitchCase",8),b.Ab(1),b.lc("ngSwitchCase",9)}}var fe,ge,pe,me,ve,Se=function(){return["/home"]},we=function(){return["/account","profile"]},Ce=l.g.forChild([{path:"",pathMatch:"full",redirectTo:"signIn"},{path:"register",component:(me=function(){function e(s,t,i,r){var n=this;_classCallCheck(this,e),this.userService=s,this.infoService=t,this.router=i,this.systemService=r,this._subs=[],this.systemService.toggleNavbar(!0),this.systemService.toggleSidebar(!0),this.theUser={email:"",passwd:"",passwd2:""},this.isChecking=!1,this.formValidator={email:{errMsgs:[],presetErrs:[]},passwd:{errMsgs:[],presetErrs:[]},passwd2:{errMsgs:[],presetErrs:[]}},this.cssSuccess={"has-success":!0,"has-error":!1},this.cssError={"has-success":!1,"has-error":!0},this.cssHidden={"has-success":!1,"has-error":!1},this.isSubmitted=!1,this.isSuccess=!1,this.hasErrors=[],this._viewControls={isRecaptchaClicked:!1},this._subs.push(this.userService.currentUser$.subscribe((function(e){return e.isLoggedIn?n.router.navigate(["/project/list"]):""})))}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.systemService.sysInfo$.subscribe((function(s){s&&(e.reCaptchaSiteKey=s.reCaptchaSiteKey,e.googleClientID=s.googleClientID)}))}},{key:"validEmail",value:function(){var e=this.formValidator.email,s=new RegExp('^(([^<>()[\\]\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\.,;:\\s@"]+)*)|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$');return e.errMsgs.length=0,e.presetErrs.length>0&&e.errMsgs.push.apply(e.errMsgs,e.presetErrs),s.test(this.theUser.email)||e.errMsgs.push("Please check your email format."),this.isChecking?0===e.errMsgs.length?this.cssSuccess:this.cssError:this.cssHidden}},{key:"validPasswd",value:function(){var e=this.formValidator.passwd,s=this.theUser.passwd&&this.theUser.passwd.length?this.theUser.passwd.length:0;return e.errMsgs.length=0,e.presetErrs.length>0&&e.errMsgs.push.apply(e.errMsgs,e.presetErrs),(s<8||s>64)&&e.errMsgs.push("This password must be between 8 and 64 characters"),this.isChecking?0===e.errMsgs.length?this.cssSuccess:this.cssError:this.cssHidden}},{key:"validPasswd2",value:function(){var e=this.formValidator.passwd2;return e.errMsgs.length=0,e.presetErrs.length>0&&e.errMsgs.push.apply(e.errMsgs,e.presetErrs),this.theUser.passwd!==this.theUser.passwd2&&e.errMsgs.push("Password does not match."),this.theUser.passwd2&&0!==this.theUser.passwd2.length||e.errMsgs.push("Cannot be empty"),this.isChecking?0===e.errMsgs.length?this.cssSuccess:this.cssError:this.cssHidden}},{key:"handleCorrectCaptcha",value:function(e){this.recaptchaResponse=e}},{key:"onSubmit",value:function(){var e=this;this.isChecking=!1,(this.validEmail()||this.validPasswd()||this.validPasswd2())&&(this.isChecking=!0,this._viewControls.isRecaptchaClicked=!!this.recaptchaResponse,0===this.formValidator.email.errMsgs.length&&0===this.formValidator.passwd.errMsgs.length&&0===this.formValidator.passwd2.errMsgs.length&&(this.reCaptchaSiteKey&&this.recaptchaResponse||!this.reCaptchaSiteKey)?(this._subs.push(this.userService.register(this.theUser.email,this.theUser.passwd,this.recaptchaResponse).subscribe((function(s){if(s.isError){var t=e.formValidator.email;t.presetErrs=[];var i=e.formValidator.passwd;i.presetErrs=[],e.formValidator.passwd2.presetErrs=[],e.isSuccess=!0,e.isSubmitted=!1,setTimeout((function(){e.reCaptchaComponent&&e.reCaptchaComponent.reset()}),0);for(var r=0;r<s.errors.length;r++){var n=s.errors[r];"1"===n.code&&t.presetErrs.push(n.name),"3"===n.code&&i.presetErrs.push(n.name),e.hasErrors.push(n.name)}}else e.isSuccess=!0,e.infoService.addMessage("7"),e.router.navigate(["/project/list"])}),(function(e){this.isSuccess=!1,this.hasErrors.push("Connection error: Please try again latter."),this.hasErrors.push("If this message keeps showing, please contact the web admin.")}))),this.isSubmitted=!0,this.formValidator.email.presetErrs=[],this.formValidator.passwd.presetErrs=[],this.formValidator.passwd2.presetErrs=[],this.hasErrors=[]):this.reCaptchaComponent&&this.reCaptchaComponent.reset())}},{key:"resetForm",value:function(){this.theUser={email:"",passwd:"",passwd2:""},this.formValidator={email:{errMsgs:[],presetErrs:[]},passwd:{errMsgs:[],presetErrs:[]},passwd2:{errMsgs:[],presetErrs:[]}},this.isChecking=!1,this.reCaptchaComponent&&this.reCaptchaComponent.reset()}},{key:"gotoAuth",value:function(e,s){e.preventDefault(),e.stopImmediatePropagation(),this.userService.oAuthSign(s)}},{key:"sendInfoCss",value:function(){var e={"fa-circle-o-notch":!0,"fa-spin":!0,"fa-times":!1,"fa-check":!1};return this.isSuccess&&(e={"fa-circle-o-notch":!1,"fa-spin":!1,"fa-times":!1,"fa-check":!0}),this.hasErrors.length>0&&(e={"fa-circle-o-notch":!1,"fa-spin":!1,"fa-times":!0,"fa-check":!1}),e}},{key:"statusCss",value:function(e){var s;switch(e){case 1:s={"text-danger":!1,"text-warning":!0};break;case 2:s={"text-danger":!0,"text-warning":!1};break;default:s={"text-danger":!1,"text-warning":!1}}return s}},{key:"ngOnDestroy",value:function(){this._subs.forEach((function(e){return e.unsubscribe()}))}},{key:"diagnostic",get:function(){return JSON.stringify(this.formValidator)}}]),e}(),me.\u0275fac=function(e){return new(e||me)(b.Mb(u.a),b.Mb(h.a),b.Mb(l.c),b.Mb(d.a))},me.\u0275cmp=b.Gb({type:me,selectors:[["user-register"]],viewQuery:function(e,s){var t;1&e&&b.Pc(n.a,!0),2&e&&b.vc(t=b.bc())&&(s.reCaptchaComponent=t.first)},decls:20,vars:8,consts:[["aria-label","breadcrumb","role","navigation"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],["aria-current","page",1,"breadcrumb-item","active"],[1,"bdp-main-container"],[1,"chi-header"],["class","form col-md-12 center-block",3,"ngSubmit",4,"ngIf"],[3,"hidden"],[3,"text-danger",4,"ngIf"],["class","text-danger",4,"ngIf"],[4,"ngIf"],[1,"form","col-md-12","center-block",3,"ngSubmit"],["userForm","ngForm"],[1,"form-group","row",3,"ngClass"],["for","email",1,"col-sm-2","control-label"],[1,"col-sm-10"],[2,"width","100%"],["matInput","","type","text","name","email","placeholder","What's your email address?",3,"ngModel","ngModelChange","keyup"],["email","ngModel"],["for","passwd",1,"col-sm-2","control-label"],["matInput","","type","password","name","passwd","placeholder","Choose a password",3,"ngModel","ngModelChange","keyup"],["for","passwd2",1,"col-sm-2","control-label"],["matInput","","type","password","name","passwd2","placeholder","Confirm your passowrd",3,"ngModel","ngModelChange","keyup"],[1,"form-group","row"],[3,"siteKey","resolved",4,"ngIf"],[1,"col-sm-2"],["mat-raised-button","","color","primary","type","submit"],["mat-button","","type","reset",3,"click"],[1,"clearfix"],[1,"my-2",2,"margin","10px","border-top","1px solid #8e95a5","text-align","center","height","0px","margin","10px"],[2,"position","relative","bottom","10px","background","rgba(255, 255, 255, 0.5)","padding","0 12px"],[1,"row"],["type","button",1,"btn","btn-danger","col-sm-3","col-xs-6","pull-left","text-center",2,"height","40px",3,"disabled","click"],[1,"fab","fa-google"],[1,"text-center",2,"font-size","12pt"],["class","text-danger",4,"ngFor","ngForOf"],[1,"text-danger"],[3,"siteKey","resolved"],[1,"fa","fa-fw",3,"ngClass"],["aria-hidden","true",1,"fa","fa-exclamation-triangle"],[1,"link",3,"click"],["aria-hidden","true",1,"fa","fa-times","fa-fw"],[1,"text-success"],["aria-hidden","true",1,"fa","fa-check","fa-fw"]],template:function(e,s){1&e&&(b.Sb(0,"nav",0),b.Sb(1,"ol",1),b.Sb(2,"li",2),b.Sb(3,"a",3),b.Jc(4,"Home"),b.Rb(),b.Rb(),b.Sb(5,"li",4),b.Jc(6,"Registration"),b.Rb(),b.Rb(),b.Rb(),b.Sb(7,"div",5),b.Sb(8,"h3",6),b.Jc(9,"Registration"),b.Rb(),b.Nb(10,"br"),b.Nb(11,"br"),b.Nb(12,"br"),b.Hc(13,_,44,12,"form",7),b.Sb(14,"div",8),b.Hc(15,V,3,3,"h3",9),b.Hc(16,P,3,0,"h3",10),b.Hc(17,K,8,1,"h4",11),b.Hc(18,T,20,0,"div",11),b.Nb(19,"hr"),b.Rb(),b.Rb()),2&e&&(b.Ab(3),b.lc("routerLink",b.oc(7,F)),b.Ab(10),b.lc("ngIf",!s.isSubmitted),b.Ab(1),b.lc("hidden",!s.isSubmitted),b.Ab(1),b.lc("ngIf",0===s.hasErrors.length&&!s.isSuccess),b.Ab(1),b.lc("ngIf",0!==s.hasErrors.length),b.Ab(1),b.lc("ngIf",0!==s.hasErrors.length),b.Ab(1),b.lc("ngIf",s.isSuccess&&0===s.hasErrors.length))},directives:[l.f,r.n,i.o,i.j,i.k,r.l,f.b,o.a,i.b,i.i,i.l,a.b,r.m,n.a],encapsulation:2}),me)},{path:"email-verifying",component:(pe=function(){function e(s,t,i,r,n){_classCallCheck(this,e),this.route=s,this.router=t,this.infoService=i,this.systemService=r,this.userService=n,this.hasCode=!1,this.heading="",this.status=void 0,this.isVerified=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.systemService.toggleNavbar(!0),this.systemService.toggleSidebar(!0),this.sub=this.route.queryParamMap.subscribe((function(s){var t;switch(void 0!==s.get("code")?(t=s.get("code"),e.hasCode=!0,e.status=e.infoService.addMessage(t)):(e.hasCode=!1,e.status=void 0,e.router.navigate(["/home"])),t){case"a004":e.heading="The verification token is invalid.",e.isVerified=!1;break;case"a005":e.heading="This verification token is expired.",e.isVerified=!1;break;case"a006":e.heading="The email is verified.",e.isVerified=!0;break;case"a008":e.heading="This email is already verified.",e.isVerified=!0;break;default:e.heading="Resending your verification email."}}))}},{key:"setCssClass",value:function(){var e={"fa-exclamation-triangle":!1,"fa-times":!1,"fa-check":!1,"fa-info-circle":!1};if(void 0!==this.status)switch(this.status.type){case"warning":e["fa-exclamation-triangle"]=!0;break;case"error":e["fa-times"]=!0;break;case"info":e["fa-info-circle"]=!0;break;case"success":e["fa-check"]=!0}return e}},{key:"headerCss",value:function(){var e={"text-warning":!1,"text-danger":!1,"text-success":!1};if(void 0!==this.status)switch(this.status.type){case"warning":e={"text-warning":!0,"text-danger":!1,"text-success":!1};break;case"error":e={"text-warning":!1,"text-danger":!0,"text-success":!1};break;case"success":e={"text-warning":!1,"text-danger":!1,"text-success":!0}}return e}},{key:"reVerify",value:function(){this.userService.emailResend().subscribe((function(e){}))}},{key:"ngOnDestroy",value:function(){this.sub&&this.sub.unsubscribe()}}]),e}(),pe.\u0275fac=function(e){return new(e||pe)(b.Mb(l.a),b.Mb(l.c),b.Mb(h.a),b.Mb(d.a),b.Mb(u.a))},pe.\u0275cmp=b.Gb({type:pe,selectors:[["email-verify"]],decls:10,vars:4,consts:[[1,"bdp-main-container"],[3,"ngClass",4,"ngIf"],[4,"ngIf"],[3,"ngClass"],["aria-hidden","true",1,"fas","fa-fw",3,"ngClass"],[3,"routerLink"]],template:function(e,s){1&e&&(b.Sb(0,"div",0),b.Sb(1,"h1"),b.Jc(2,"Email verification"),b.Rb(),b.Hc(3,L,3,3,"h3",1),b.Sb(4,"h4"),b.Jc(5,"You may proceed the follow actions."),b.Rb(),b.Sb(6,"ul"),b.Hc(7,G,3,2,"div",2),b.Hc(8,Z,3,2,"div",2),b.Rb(),b.Hc(9,Q,1,0,"h3",2),b.Rb()),2&e&&(b.Ab(3),b.lc("ngIf",s.hasCode),b.Ab(4),b.lc("ngIf",!s.userService.isSignedIn),b.Ab(1),b.lc("ngIf",s.userService.isSignedIn),b.Ab(1),b.lc("ngIf",!s.hasCode))},directives:[r.n,r.l,l.f],encapsulation:2}),pe)},{path:"signIn",component:A},{path:"forgot-password",component:(ge=function(){function e(s){_classCallCheck(this,e),this.userService=s}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){}}]),e}(),ge.\u0275fac=function(e){return new(e||ge)(b.Mb(u.a))},ge.\u0275cmp=b.Gb({type:ge,selectors:[["forgot-passwd"]],decls:3,vars:0,consts:[[1,"container-fluid"]],template:function(e,s){1&e&&(b.Sb(0,"div",0),b.Sb(1,"h1"),b.Jc(2,"Forgot your passowrd?"),b.Rb(),b.Rb())},encapsulation:2}),ge)},{path:"profile",component:(fe=function(){function e(s,t,i){_classCallCheck(this,e),this.userService=s,this.router=t,this.systemService=i,this._subs=[]}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.systemService.toggleNavbar(!0),this.systemService.toggleSidebar(!0),this._viewControls={isEditName:!1,showResendEmail:!0,mailSent:!1,newName:""},this._subs.push(this.userService.currentUser$.subscribe((function(s){e.currentUser=s,e._viewControls.newName=e.currentUser.name,s.isLoggedIn||e.router.navigate(["/account/signIn"])})))}},{key:"reVerify",value:function(){var e=this;this._viewControls.showResendEmail=!1,this._subs.push(this.userService.emailResend().subscribe((function(s){s.isError||s.success&&s.success.resend&&(e._viewControls.mailSent=!0)})))}},{key:"rename",value:function(){var e=this,s=this._viewControls.newName;this._viewControls.isEditName=!1;var t=this.currentUser.name;this.currentUser.name=s;var i=this.userService.rename(s).subscribe((function(s){i.unsubscribe(),s.isError&&(e.currentUser.name=t)}))}},{key:"ngOnDestroy",value:function(){this._subs.forEach((function(e){return e.unsubscribe()}))}}]),e}(),fe.\u0275fac=function(e){return new(e||fe)(b.Mb(u.a),b.Mb(l.c),b.Mb(d.a))},fe.\u0275cmp=b.Gb({type:fe,selectors:[["user-profile"]],decls:16,vars:7,consts:[[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"routerLink"],[1,"breadcrumb-item","active"],["target","_blank",3,"routerLink"],[1,"fas","fa-external-link-alt","ml-3"],[1,"bdp-main-container"],[1,"chi-header"],["class","container-fluid",4,"ngIf"],[1,"container-fluid"],[1,"row"],[1,"col-md-3"],[1,"col-md-9"],[4,"ngIf"],[1,"col-md-9",3,"ngSwitch"],[4,"ngSwitchCase"],["mat-icon-button",""],[1,"fas","fa-pencil-alt","fa-fw","fa-lg",3,"click"],["matInput","","type","text","maxlength","60","length","60",3,"ngModel","ngModelChange","keyup.enter"],["mat-icon-button","","color","primary",3,"click"],[1,"fas","fa-save","fa-fw","mx-2","fa-lg"],["mat-icon-button","",3,"click"],[1,"fas","fa-times","fa-fw","mx-2","fa-lg"],["class","link","style","text-decoration: underline;",3,"click",4,"ngIf"],[1,"link",2,"text-decoration","underline",3,"click"],[1,"fa","fa-circle-o-notch","fa-spin","fa-fw"]],template:function(e,s){1&e&&(b.Sb(0,"ol",0),b.Sb(1,"li",1),b.Sb(2,"a",2),b.Jc(3,"Home"),b.Rb(),b.Rb(),b.Sb(4,"li",3),b.Sb(5,"a",2),b.Jc(6,"User Profile"),b.Rb(),b.Sb(7,"a",4),b.Nb(8,"i",5),b.Rb(),b.Rb(),b.Rb(),b.Sb(9,"div",6),b.Sb(10,"h3",7),b.Jc(11,"User Profile"),b.Rb(),b.Nb(12,"br"),b.Nb(13,"br"),b.Nb(14,"br"),b.Hc(15,de,37,15,"div",8),b.Rb()),2&e&&(b.Ab(2),b.lc("routerLink",b.oc(4,Se)),b.Ab(3),b.lc("routerLink",b.oc(5,we)),b.Ab(2),b.lc("routerLink",b.oc(6,we)),b.Ab(8),b.lc("ngIf",s.currentUser&&s.currentUser.auths))},directives:[l.f,r.n,r.p,r.q,a.b,f.b,o.a,i.b,i.e,i.i,i.l],encapsulation:2}),fe)}]),Re=((ve=function e(){_classCallCheck(this,e)}).\u0275mod=b.Kb({type:ve}),ve.\u0275inj=b.Jb({factory:function(e){return new(e||ve)},providers:[],imports:[[r.c,i.d,n.b,a.c,o.b,c.b,Ce]]}),ve)}}]);