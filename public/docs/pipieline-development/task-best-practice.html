

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Guideline to plan tasks into packages on Bio-Data Processor &mdash; Bio-Data Processor  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Bio-Data Processor
          

          
            
            <img src="../_static/bdp-logo-dark.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.8.beta
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Concept</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorial-full-step-pipelines.html">Full steps to construct a pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorial-task-deploy-GCP.html">Task deployment on Google Cloud Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/mongodb-non-root-installation.html">Non-root MongoDB Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Quick Start</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorial-full-step-pipelines.html">Full steps to construct a pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorial-task-deploy-GCP.html">Task deployment on Google Cloud Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/mongodb-non-root-installation.html">Non-root MongoDB Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">System Administrations</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../administration/allow-google-sign-in.html">Enable Google 3rd party sign-in</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Bio-Data Processor</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Guideline to plan tasks into packages on Bio-Data Processor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/pipieline-development/task-best-practice.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="guideline-to-plan-tasks-into-packages-on-bio-data-processor">
<h1>Guideline to plan tasks into packages on Bio-Data Processor<a class="headerlink" href="#guideline-to-plan-tasks-into-packages-on-bio-data-processor" title="Permalink to this headline">¶</a></h1>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p><strong>Targeted readers</strong>: pipeline developers</p>
</div>
<p>Bio-Data Processor is a <strong>light-weight</strong>, yet <strong>complete</strong> and
<strong>scalable</strong> platform for bio-data processing. Instead of supporting
every circumstances to execute tasks, we set a few rules for your
scripts/programs to easily integrate into Bio-Data processor.</p>
<div class="section" id="four-mandatory-points">
<h2>Four mandatory points<a class="headerlink" href="#four-mandatory-points" title="Permalink to this headline">¶</a></h2>
<div class="section" id="do-expose-all-output-paths-as-input-arguments">
<h3>1. Do expose all output paths as input arguments.<a class="headerlink" href="#do-expose-all-output-paths-as-input-arguments" title="Permalink to this headline">¶</a></h3>
<p>All output files/folders have to be specified through arguments when executing your script/program. Namely, Your scripts/programs should accepts arguments of all output file/folder paths. In this way, Bio-Data Processor can then understand which arguments are the task outputs and can track these output file/folder as data file records.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A task may generate many output files. In this case, we can plan to generate a single output folder for this task, and all output files with any complex folder structure can then be organized in this folder.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Intermediate outputs are recommended to be generated inside an output folder. When this output folder is set as an argument, users can directly examine these intermediate outputs on Bio-Data Processor.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Bio-Data Processor does not tightly control the file outputs to maintain light weighted. Developers are suggested to know where the output files are (see <a class="reference internal" href="#dangeroutput"><span class="std std-ref">the third suggested point below</span></a>). If the outputs are created in the <code class="docutils literal notranslate"><span class="pre">current</span> <span class="pre">working</span> <span class="pre">directory</span></code>, we provided web interface for you to set the <code class="docutils literal notranslate"><span class="pre">cwd</span></code> property for that task. The default <code class="docutils literal notranslate"><span class="pre">cwd</span></code> is the <code class="docutils literal notranslate"><span class="pre">$ProjectFolder</span></code> that specifies the project folder path.</p>
</div>
</div>
<div class="section" id="for-input-output-files-accepts-the-absolute-full-path-s-as-arguments">
<h3>2. For input/output files, accepts the absolute full path(s) as arguments.<a class="headerlink" href="#for-input-output-files-accepts-the-absolute-full-path-s-as-arguments" title="Permalink to this headline">¶</a></h3>
<p>Although Bio-Data Processor can set working directory when performing a task, it is recommended for a task to accept absolute paths as input/output file arguments. Bio-Data Processor keeps its own file structures and all file names.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If a task <strong>only accepts the output file/folder that is relative to the current working directory</strong> (e.g. output prefix), you may consider setting the task current working directory as the <code class="docutils literal notranslate"><span class="pre">$ProjectFolder</span></code> on the Bio-Data Processor and setting the argument to use only the output file/folder name only instead of the full path.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If a (batch) task <strong>needs many input files</strong>, try to plan the task that takes a single input folder as an argument that contains all the input files.</p>
</div>
</div>
<div class="section" id="make-sure-to-follow-symbolic-link-of-a-folder">
<h3>3. Make sure to follow symbolic link of a folder<a class="headerlink" href="#make-sure-to-follow-symbolic-link-of-a-folder" title="Permalink to this headline">¶</a></h3>
<p>If your task accepts a single folder as an input argument, be sure to follow the symbolic link (soft link) when this folder is a soft-link to see underlying files.</p>
</div>
<div class="section" id="receive-sigterm-or-sigint-signal-for-gracefully-stop-processes">
<h3>4. Receive SIGTERM or SIGINT signal for gracefully stop processes<a class="headerlink" href="#receive-sigterm-or-sigint-signal-for-gracefully-stop-processes" title="Permalink to this headline">¶</a></h3>
<p>This is usually the default behavior for a script/program to stop. If your scripts/programs intercept these two signals, please make sure your task will stop itself gracefully, e.g. removing all intermediate files or stop all child processes.</p>
</div>
</div>
<div class="section" id="three-suggested-points">
<h2>Three suggested points<a class="headerlink" href="#three-suggested-points" title="Permalink to this headline">¶</a></h2>
<div class="section" id="wrap-your-tasks-running-inside-a-docker-container">
<h3>1. Wrap your tasks running inside a docker container.<a class="headerlink" href="#wrap-your-tasks-running-inside-a-docker-container" title="Permalink to this headline">¶</a></h3>
<p>Although Bio-Data Processor can execute commands directly using host resources, we strongly encourage you to plan all your tasks running inside a bio-container (a docker container that based on bio-container). In this way, these tasks are cross-platformed and users need not worry about the task running environments.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>We provide a way for you to encapsulate your tasks/pipelines into a package container of Bio-Data Processor.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Many adapters are developed to perform your tasks on different environments. (e.g. a server with a cluster architecture with SGE/PBS, cloud computing (Google Cloud/Microsoft Azure/Amazon web service, etc.), with CWL or WDL, or simply on a single workstation.)</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you plan tasks that are performed directly on the host, make sure you do use cross-platform language and all required environments are well-set on the host. We strongly recommend to do this only when testing or development purposes.</p>
</div>
</div>
<div class="section" id="do-not-handle-batch-tasks-by-yourself">
<h3>2. Do NOT handle batch tasks by yourself<a class="headerlink" href="#do-not-handle-batch-tasks-by-yourself" title="Permalink to this headline">¶</a></h3>
<p>Some tasks may process a bunch of files with same arguments. This is called a batch task. Most of the time, batch tasks are considered as independent tasks and can be executed parallel. If you hard-coded the <code class="docutils literal notranslate"><span class="pre">for-loop</span></code> inside your script, these tasks can only be executed one by one. Bio-Data Processor provides a way for you to configure this kind of batch tasks. You may loop over some kinds of lists, e.g. file globs, list from csv or excel files. Developers should focus on building each task unit and need NOT worry about the parallel task executions, since there may be different kinds of task parallelism or no parallel environments at run time.</p>
<p>Bio-Data Processor applied different kinds of adapters to handle the task parallelisms for you. For each task, developers configure ONE single task definition and the task can then be deployed on different run-time environments, e.g. a local workstation, High-Performance computing (HPC) clusters, cloud computings.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Please click here to see how to define a batch task on Bio-Data Processor.</p>
</div>
</div>
<div class="section" id="be-careful-when-outputting-files-in-input-folders">
<span id="dangeroutput"></span><h3>3. Be careful when outputting files in input folders<a class="headerlink" href="#be-careful-when-outputting-files-in-input-folders" title="Permalink to this headline">¶</a></h3>
<p>Usually, we do NOT recommended writing files in input folders, since the file writing conflicts may occur. That is, multiple process may write data into the same file. Usually, the OS will lock the file for the first process, and other process will not have permissions to write data. Hence, the task will fail.</p>
<p>Bio-Data Processor allows writing files into input folders because the output details are not tightly controled. We preserve the most flexible circumstances to run a task. However, be sure to create unique files under the input folders.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Please write output or temp files in the output files. If the intermediate temp files are not so important, you may consider to write temp files into the <code class="docutils literal notranslate"><span class="pre">/tmp/</span></code> folder. Each task is independent in a docker container. Namely, the <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> is not shared among different processes. In this way, you can write the temp file using the same name.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Chi Yang

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>